<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Keep Your AWS service secure | Samma.io</title>
  <link rel = 'canonical' href = 'https://samma.io/posts/2011-06-02-keep-your-aws-secure/'>
  <meta name="description" content="Samma is a set och opensource scanners set toghter to keep you system secure.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Keep Your AWS service secure" />
<meta property="og:description" content="Keep your aws targets synced In AWS sometimes you get alot of ec2 and public ip fast. And you may want to keep them scanned and up to sync So then its some easy task you can do. You will also see a list of ip in grafana and kibana
Find your public ip In your aws cli run this command to get your public ip
aws ec2 describe-instances | grep PublicIpAddress | grep -o -P &quot;\d&#43;\." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://samma.io/posts/2011-06-02-keep-your-aws-secure/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-02T09:00:00+00:00" />
<meta property="article:modified_time" content="2021-06-02T09:00:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Keep Your AWS service secure"/>
<meta name="twitter:description" content="Keep your aws targets synced In AWS sometimes you get alot of ec2 and public ip fast. And you may want to keep them scanned and up to sync So then its some easy task you can do. You will also see a list of ip in grafana and kibana
Find your public ip In your aws cli run this command to get your public ip
aws ec2 describe-instances | grep PublicIpAddress | grep -o -P &quot;\d&#43;\."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://samma.io/css/styles.56a104c35e8692dad52597e01c30f782c8612bf9ce3b1d4572c71eff0049b8edd71457436be28a9a537080647849a63f529ea68b0316bb562b9fdd9641492b3c.css" integrity="sha512-VqEEw16GktrVJZfgHDD3gshhK/nOOx1Fcsce/wBJuO3XFFdDa&#43;KKmlNwgGR4SaY/Up6miwMWu1Yrn92WQUkrPA=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://samma.io/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/scanners">Scanners</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/support">Support</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://samma.io/scanners/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://samma.io/posts/2021-07-11-find-secrity-problems-early/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&text=Keep%20Your%20AWS%20service%20secure" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&title=Keep%20Your%20AWS%20service%20secure" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&is_video=false&description=Keep%20Your%20AWS%20service%20secure" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Keep%20Your%20AWS%20service%20secure&body=Check out this article: https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&title=Keep%20Your%20AWS%20service%20secure" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&title=Keep%20Your%20AWS%20service%20secure" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&name=Keep%20Your%20AWS%20service%20secure&description=Keep%20your%20aws%20targets%20synced%20In%20AWS%20sometimes%20you%20get%20alot%20of%20ec2%20and%20public%20ip%20fast.%20And%20you%20may%20want%20to%20keep%20them%20scanned%20and%20up%20to%20sync%20So%20then%20its%20some%20easy%20task%20you%20can%20do.%20You%20will%20also%20see%20a%20list%20of%20ip%20in%20grafana%20and%20kibana%0aFind%20your%20public%20ip%20In%20your%20aws%20cli%20run%20this%20command%20to%20get%20your%20public%20ip%0aaws%20ec2%20describe-instances%20%7c%20grep%20PublicIpAddress%20%7c%20grep%20-o%20-P%20%26quot%3b%5cd%2b%5c." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&t=Keep%20Your%20AWS%20service%20secure" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#keep-your-aws-targets-synced">Keep your aws targets synced</a>
      <ul>
        <li><a href="#find-your-public-ip">Find your public ip</a></li>
        <li><a href="#add-scanner-to-thoose-is-now-simple">Add scanner to thoose is now simple</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Keep Your AWS service secure
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2021-06-02 09:00:00 &#43;0000 UTC" itemprop="datePublished">2021-06-02</time>
          
        </div>
        
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/aws">AWS</a>
            
             ,  
            <a class="category-link" href="/categories/cloud">Cloud</a>
            
             ,  
            <a class="category-link" href="/categories/k8s">k8s</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/aws" rel="tag">AWS</a>
            
             ,  
            <a class="tag-link" href="/tags/devsecops" rel="tag">DevSecOps</a>
            
             ,  
            <a class="tag-link" href="/tags/scanner" rel="tag">Scanner</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="keep-your-aws-targets-synced">Keep your aws targets synced</h2>
<p>In AWS sometimes you get alot of ec2 and public ip fast. And you may want to keep them scanned and up to sync
So then its some easy task you can do.
You will also see a list of ip in grafana and kibana</p>
<h3 id="find-your-public-ip">Find your public ip</h3>
<p>In your aws cli run this command to get your public ip</p>
<pre tabindex="0"><code>aws ec2 describe-instances | grep PublicIpAddress | grep -o -P &quot;\d+\.\d+\.\d+\.\d+&quot; | grep -v '^10\.'
</code></pre><h3 id="add-scanner-to-thoose-is-now-simple">Add scanner to thoose is now simple</h3>
<p>First get the ip and save to file</p>
<pre tabindex="0"><code>aws ec2 describe-instances | grep PublicIpAddress | grep -o -P &quot;\d+\.\d+\.\d+\.\d+&quot; | grep -v '^10\.' &gt;&gt; ip.txt
</code></pre><p>Now run the bash script to create scanners with helm</p>
<pre tabindex="0"><code>input=&quot;ip.txt&quot;
while IFS= read -r line
do
  TARGET=$line
  NAME=$line
  HOURE=$(shuf -i 7-10 -n 1)
  MINUTE=$(shuf -i 0-60 -n 1)

  helm uninstall tsunamo-ip-$NAME -n samma-io
  helm upgrade --install tsunamo-ip-$NAME  --debug --set ip=$TARGET  /home/mahe/helm-repo/tsunami -n samma-io
  helm uninstall $NAME -n samma-io
  helm upgrade --install $NAME  --debug --set target=$TARGET --set schedule=&quot;$MINUTE $HOURE * * 5&quot; --set image.tag=v0.2 /home/mahe/helm-repo/nmap -n samma-io
  helm uninstall nikto-$NAME -n samma-io 
  helm upgrade --install nikto-$NAME  --debug --set target=$TARGET --set schedule=&quot;$MINUTE $HOURE * * 5&quot; /home/mahe/helm-repo/nikto  -n samma-io
done &lt; &quot;$input&quot;

</code></pre><p>From this it shouls be a simple task to update your scanns. Tips are to create a namespaces with your aws scanners and then simple delete that namespace to remove all scanners. And then run this script to add the new.
In that way the scanners are always updated.</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/scanners">Scanners</a></li>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/support">Support</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#keep-your-aws-targets-synced">Keep your aws targets synced</a>
      <ul>
        <li><a href="#find-your-public-ip">Find your public ip</a></li>
        <li><a href="#add-scanner-to-thoose-is-now-simple">Add scanner to thoose is now simple</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&text=Keep%20Your%20AWS%20service%20secure" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&title=Keep%20Your%20AWS%20service%20secure" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&is_video=false&description=Keep%20Your%20AWS%20service%20secure" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Keep%20Your%20AWS%20service%20secure&body=Check out this article: https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&title=Keep%20Your%20AWS%20service%20secure" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&title=Keep%20Your%20AWS%20service%20secure" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&name=Keep%20Your%20AWS%20service%20secure&description=Keep%20your%20aws%20targets%20synced%20In%20AWS%20sometimes%20you%20get%20alot%20of%20ec2%20and%20public%20ip%20fast.%20And%20you%20may%20want%20to%20keep%20them%20scanned%20and%20up%20to%20sync%20So%20then%20its%20some%20easy%20task%20you%20can%20do.%20You%20will%20also%20see%20a%20list%20of%20ip%20in%20grafana%20and%20kibana%0aFind%20your%20public%20ip%20In%20your%20aws%20cli%20run%20this%20command%20to%20get%20your%20public%20ip%0aaws%20ec2%20describe-instances%20%7c%20grep%20PublicIpAddress%20%7c%20grep%20-o%20-P%20%26quot%3b%5cd%2b%5c." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fsamma.io%2fposts%2f2011-06-02-keep-your-aws-secure%2f&t=Keep%20Your%20AWS%20service%20secure" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  Samma.io 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/scanners">Scanners</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/support">Support</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
